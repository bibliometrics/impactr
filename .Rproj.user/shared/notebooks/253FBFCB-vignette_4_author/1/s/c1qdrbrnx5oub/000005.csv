"0","plot_alluvial <-  example$upset %>%"
"0","  # format data"
"0","  mutate_all(function(x){factor(x, levels = c(0, 1), labels = c(""No"", ""Yes""))}) %>%"
"0","  table() %>% tibble::as_tibble() %>%"
"0","  ggforce::gather_set_data(., x = 1:(which(colnames(.)==""n"")-1), id=""alluvium"") %>%"
"0","  dplyr::mutate(project = factor(x, levels = unique(x)),"
"0","                strata = factor(y, levels = unique(y))) %>%"
"0","  "
"0","  # select only essential columns"
"0","  dplyr::select(project, strata, n, alluvium) %>%"
"0","  "
"0","  # plot data"
"0","  ggplot() +"
"0","  aes(x = project, y = n, alluvium = alluvium, stratum = strata, fill = strata, label = strata) +"
"0","  ggalluvial::geom_flow(stat = ""alluvium"", lode.guidance = ""rightleft"", aes.flow = ""backward"", color = ""black"") +"
"0","  ggalluvial::geom_stratum(alpha = 0.7) +"
"0","  geom_text(stat = ""stratum"", size = 5) +"
"0","  scale_x_discrete(name = ""Involvement in STARSurg Project"") +"
"0","  scale_y_continuous(name = ""Total Number of Collaborators"") +"
"0","  theme_bw(base_size = 18) + guides(fill=FALSE)"
"0","  "
"0","ggsave(plot_alluvial, filename = ""~/impactr/vignettes/plot/plot_alluvial.png"","
"0","       height = 5.76*0.75, width = 9.60*0.75)"
"0",""
