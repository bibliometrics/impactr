dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = as.integer(purrr::map_chr(~ id_doi,
function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)})))}
id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = as.integer(purrr::map_chr(~ id_doi,
function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)})))
id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = dplyr::pull(., id_doi) %>%
purrr::map_chr(function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)}) %>%
as.integer())
dplyr::pull(data_doi, id_doi)
dplyr::pull(data_doi, id_doi) %>%
purrr::map_chr(function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)})
tryCatch(rcrossref::cr_citation_count(doi = dplyr::pull(data_doi, id_doi)), error=function(e) NA)
id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
purrr::map_df(id_doi, function(x){tryCatch(rcrossref::cr_citation_count(doi = dplyr::pull(data_doi, id_doi)), error=function(e) NA)})
id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
purrr::map_df(~ id_doi, function(x){tryCatch(rcrossref::cr_citation_count(doi = dplyr::pull(data_doi, id_doi)), error=function(e) NA)})
id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %$%
purrr::map_df(~ id_doi, function(x){tryCatch(rcrossref::cr_citation_count(doi = dplyr::pull(data_doi, id_doi)), error=function(e) NA)})
id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = dplyr::pull(data_doi, id_doi) %>%
purrr::map_chr(function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA) %>% dplyr::pull(count)}) %>%
as.integer())
data_doi <- NULL
if("doi" %in% id_class$id_type){
data_doi <- id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = dplyr::pull(data_doi, id_doi) %>%
purrr::map_chr(function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA) %>% dplyr::pull(count)}) %>%
as.integer())}
"pmid", "invalid"))))
data_doi <- NULL
if("doi" %in% id_class$id_type){
data_doi <- id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = purrr::map_chr(id_doi, function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA) %>%
dplyr::pull(count) %>%
as.integer()}))}
data_doi
data_pmid <- NULL
if("pmid" %in% id_class$id_type){
data_pmid <- id_class %>%
dplyr::filter(id_type=="pmid") %>%
dplyr::mutate(id_pmid = id) %>%
dplyr::mutate(id_doi = ifelse(is.null(rcrossref::id_converter(id_pmid, type="pmid")$records$doi)==T,NA,
rcrossref::id_converter(id_pmid, type="pmid")$records$doi)) %>%
dplyr::mutate(cite = as.integer(purrr::map_chr(id_doi,
function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)})))}
data_pmid
data_pmid <- NULL
if("pmid" %in% id_class$id_type){
data_pmid <- id_class %>%
dplyr::filter(id_type=="pmid") %>%
dplyr::mutate(id_pmid = id) %>%
dplyr::mutate(id_doi = ifelse(is.null(rcrossref::id_converter(id_pmid, type="pmid")$records$doi)==T,NA,
rcrossref::id_converter(id_pmid, type="pmid")$records$doi)) %>%
dplyr::mutate(cite = as.integer(purrr::map_chr(id_doi,
function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)})))}
data_invalid <- NULL
if("invalid" %in% id_class$id_type){
data_invalid <- id_class %>%
dplyr::filter(id_type=="invalid") %>%
dplyr::mutate(id_pmid = NA, id_doi = NA, cite = NA)}
cr_data <- dplyr::bind_rows(data_doi, data_pmid, data_invalid) %>%
dplyr::arrange(n)
cr_data
cite_cr <- function(id){
id_class <- id %>%
tibble::enframe(name = "n", value = "id") %>%
# https://www.crossref.org/blog/dois-and-matching-regular-expressions/
dplyr::mutate(id_type = suppressWarnings(dplyr::if_else(grepl("^10\\.\\d{4,9}/", id)==T,
"doi",
if_else(nchar(id)==8&is.numeric(as.numeric(id))==T,
"pmid", "invalid"))))
data_doi <- NULL
if("doi" %in% id_class$id_type){
data_doi <- id_class %>%
dplyr::filter(id_type=="doi") %>%
dplyr::mutate(id_pmid = NA,
id_doi = id) %>%
dplyr::mutate(cite = purrr::map_chr(id_doi, function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA) %>%
dplyr::pull(count) %>%
as.integer()}))}
data_pmid <- NULL
if("pmid" %in% id_class$id_type){
data_pmid <- id_class %>%
dplyr::filter(id_type=="pmid") %>%
dplyr::mutate(id_pmid = id) %>%
dplyr::mutate(id_doi = ifelse(is.null(rcrossref::id_converter(id_pmid, type="pmid")$records$doi)==T,NA,
rcrossref::id_converter(id_pmid, type="pmid")$records$doi)) %>%
dplyr::mutate(cite = as.integer(purrr::map_chr(id_doi,
function(x){tryCatch(rcrossref::cr_citation_count(doi = x), error=function(e) NA)})))}
data_invalid <- NULL
if("invalid" %in% id_class$id_type){
data_invalid <- id_class %>%
dplyr::filter(id_type=="invalid") %>%
dplyr::mutate(id_pmid = NA, id_doi = NA, cite = NA)}
cr_data <- dplyr::bind_rows(data_doi, data_pmid, data_invalid) %>%
dplyr::arrange(n)
return(cr_data)}
df %>%
dplyr::select(doi) %>%
dplyr::filter(is.na(doi)==F) %>%
dplyr::mutate(cite_cr = cite_cr(doi)$cite) %>%
dplyr::right_join(dplyr::select(df, -dplyr::matches("cite_cr")), by = "doi") %>%
dplyr::select(-cite_cr, everything())}
df %>%
dplyr::select(doi) %>%
dplyr::filter(is.na(doi)==F) %>%
dplyr::mutate(cite_cr = cite_cr(doi)$cite) %>%
dplyr::right_join(dplyr::select(df, -dplyr::matches("cite_cr")), by = "doi") %>%
dplyr::select(-cite_cr, everything())
df %>%
dplyr::select(doi) %>%
dplyr::filter(is.na(doi)==F) %>%
dplyr::mutate(cite_dim = impactr::cite_dim(doi)$cite) %>%
dplyr::right_join(dplyr::select(df, -dplyr::matches("cite_dim")), by = "doi") %>%
dplyr::select(-cite_dim, everything())
doi_oc <- df %>%
dplyr::select(doi) %>%
dplyr::filter(is.na(doi)==F) %>%
dplyr::pull(doi)
data_oc <- impactr::cite_oc(doi_oc)
data_oc
df %>%
dplyr::select(doi) %>%
dplyr::filter(is.na(doi)==F) %>%
dplyr::mutate(cite_oc = data_oc$total$cite) %>%
dplyr::right_join(dplyr::select(df, -dplyr::matches("cite_oc")), by = "doi") %>%
dplyr::select(-cite_oc, everything())
data_gs <- suppressMessages(suppressWarnings(impactr::cite_gs(df, gscholar_id = gscholar, match_title_nchar = gscholar_title_nchar)))
data_gs
df <- data_gs$df
gscholar_invalid <- data_gs$validation
df
df_out <- df %>%
dplyr::mutate_at(.vars = dplyr::vars(dplyr::starts_with("cite_")), as.numeric) %>%
dplyr::mutate(cite_max = apply(dplyr::select(., dplyr::starts_with("cite_")), 1, function(x){suppressWarnings(max(x, na.rm=T))})) %>%
dplyr::mutate(cite_max = ifelse(cite_max==-Inf, NA, cite_max))
df_time <- NULL
if(is.null(data_gs)==F|is.null(data_oc)==F){
time_gs <- NULL
if(is.null(data_gs)==F){
time_gs  <- data_gs$year %>%
dplyr::mutate(source = "gs") %>%
dplyr::select(source, doi, cite_year,cite_n,cite_cumsum) %>%
dplyr::mutate_all(as.character)}
time_oc <- NULL
if(is.null(data_oc)==F){
time_oc  <- data_oc$year %>%
dplyr::mutate(source = "oc") %>%
dplyr::select(source, everything()) %>%
dplyr::mutate_all(as.character)}
df_time <- dplyr::bind_rows(time_gs,time_oc) %>%
dplyr::mutate(source = factor(source),
doi = factor(doi),
cite_year = factor(cite_year, levels=sort(unique(cite_year))),
cite_n = as.numeric(cite_n),
cite_cumsum = as.numeric(cite_cumsum))}
df_metric <- NULL
if(metric==TRUE){df_metric <- suppressWarnings(impact_cite_metric(citations = df_out$cite_max, year = df_out$year))}
df_out <- list("df" = df_out, "time" = df_time, "metric" = df_metric, "gscholar_invalid" = gscholar_invalid)
if(gscholar==FALSE){df_out$gscholar_invalid <- NULL}
if(is.null(data_gs)==T&is.null(data_oc)==T){df_out$time <- NULL}
if(metric!=TRUE){df_out$metric <- NULL}
df_out
data_cite <- impactr::impact_cite(df = data,
crossref=TRUE, dimentions=TRUE, scopus=FALSE, oc = FALSE,
gscholar = "Ol5uNSwAAAAJ&hl", metric=TRUE)
library(impactr)
data_cite <- impactr::impact_cite(df = data,
crossref=TRUE, dimentions=TRUE, scopus=FALSE, oc = FALSE,
gscholar = "Ol5uNSwAAAAJ&hl", metric=TRUE)
knitr::opts_chunk$set(collapse = FALSE)
library(tidyverse);library(magrittr)
pmid <- readRDS("~/starsurg_impact/data/impact_pub.rds")$pmid
data <- impactr::extract_pmid(pmid) %>%
dplyr::mutate(journal_edit = ifelse(journal_full=="The Lancet", "Lancet", journal_full),
journal_edit = ifelse(journal_edit=="British Medical Journal", "BMJ-British Medical Journal", journal_edit))
data_cite <- impactr::impact_cite(df = data,crossref=TRUE, dimentions=TRUE, scopus=FALSE, oc = FALSE,
gscholar = "Ol5uNSwAAAAJ&hl", metric=TRUE)
data_cite
data_cite$output %>%
dplyr::select(doi, title, journal_edit, journal_if,
cite_pm,	cite_gs) %>%
knitr::kable(format="html") %>%
kableExtra::column_spec(which(colnames(.) %in% c("title")), width_min="7in") %>%
kableExtra::kable_styling(bootstrap_options = "striped", full_width = F) %>%
kableExtra::scroll_box(height = "400px",width = "1000px")
data_cite$df %>%
dplyr::select(doi, title, journal_edit, journal_if,
cite_pm,	cite_gs) %>%
knitr::kable(format="html") %>%
kableExtra::column_spec(which(colnames(.) %in% c("title")), width_min="7in") %>%
kableExtra::kable_styling(bootstrap_options = "striped", full_width = F) %>%
kableExtra::scroll_box(height = "400px",width = "1000px")
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs)) +
scale_x_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$output$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
scale_y_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$output$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
labs(x = "Citations per publication on PubMed", y = "Citations per publication on Google Scholar") +
theme_bw()
data_cite$df %>%
dplyr::select(cite_gs, cite_pm)
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs))
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs)) +
scale_x_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$output$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
scale_y_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$output$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
labs(x = "Citations per publication on PubMed", y = "Citations per publication on Google Scholar")
cite_max
data_cite$df
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs)) +
scale_x_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
scale_y_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
labs(x = "Citations per publication on PubMed", y = "Citations per publication on Google Scholar") +
theme_bw()
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs)) +
scale_x_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_pm, na.rm=TRUE)), expand = c(0, 0.5)) +
scale_y_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
labs(x = "Citations per publication on PubMed", y = "Citations per publication on Google Scholar") +
theme_bw()
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs)) +
scale_x_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
scale_y_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
labs(x = "Citations per publication on PubMed", y = "Citations per publication on Google Scholar") +
theme_bw()
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
data_cite$df %>%
dplyr::select(cite_gs, cite_pm) %>%
ggplot() +
geom_point(aes(x = cite_pm, y = cite_gs)) +
scale_x_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_pm, na.rm=TRUE)), expand = c(0, 0.5)) +
scale_y_continuous(breaks=c(seq(0, cite_max, by=5)),
limits = c(0, max(data_cite$df$cite_gs, na.rm=TRUE)), expand = c(0, 0.5)) +
labs(x = "Citations per publication on PubMed", y = "Citations per publication on Google Scholar") +
theme_bw()
cite_max <- data_cite$output %$% max(cite_gs/journal_if, na.rm=TRUE)
cite_max <- data_cite$df %$% max(cite_gs/journal_if, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(type=="Paper") %>%
dplyr::select("Journal" = journal_full2, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, almetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, almetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
cite_max <- data_cite$df %$% max(cite_gs/journal_if, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(type=="Paper") %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, almetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, almetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
cite_max <- data_cite$df %$% max(cite_gs/journal_if, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(type=="Paper") %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(type=="Paper") %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n())
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(type=="Paper")
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grep(type, "Paper"))
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl(type, "Paper"))
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type))
cite_max <- data_cite$df %$% max(cite_gs/journal_if, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
cite_max
cite_max <- data_cite$df %$% max(cite_gs, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
cite_if_max <- data_cite$df %$% max(cite_gs/journal_if, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_if_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point()
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point()
cite_if_max <- data_cite$df %$% max(cite_gs/journal_if, na.rm=TRUE)
data_cite$df %>%
dplyr::filter(is.na(journal_if)==F) %>%
dplyr::mutate(cite_year = cite_gs/(lubridate::year(Sys.Date())-year)) %>%
dplyr::mutate(cite_if = cite_gs / journal_if,
cite_if_year = cite_year / journal_if) %>%
dplyr::filter(grepl("Paper",type)) %>%
dplyr::select("Journal" = journal_full, journal_if,
cite_gs, cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::mutate(Journal = ifelse(Journal=="Colorectal disease : the official journal of the Association of Coloproctology of Great Britain and Ireland", "Colorectal disease", Journal)) %>%
dplyr::group_by(Journal, journal_if, cite_gs,
cite_year, cite_if, cite_if_year, year, altmetric) %>%
dplyr::summarise(n = n()) %>%
ggplot() +
aes(x = year, y = cite_if, group = Journal, colour = Journal, fill = Journal) +
geom_point() +
scale_y_continuous(breaks=c(0, 1, seq(5, cite_if_max, by=5)),minor_breaks=NULL) +
geom_hline(aes(yintercept=1), colour = "dark grey", linetype = "dashed") +
labs(x = "Year of Publication", y = "Ratio of Paper Citations : Journal Impact Factor") +
theme_bw()
data_cite$metric; impactr::impact_cite_metric(data_cite$output$cite_gs, data_cite$output$year)
data_cite$metric; impactr::impact_cite_metric(data_cite$df$cite_gs, data_cite$df$year)
